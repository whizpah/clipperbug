package clipperbug

import (
	"fmt"
	clipper "github.com/ctessum/go.clipper"
	"gocv.io/x/gocv"
	"image"

	"image/color"
	"math"
	"testing"
)

func TestClipperIntersection(t *testing.T) {

	paths1 := clipper.Paths{
		{{5995, 19804}, {5995, 19851}, {6007, 19853}, {6006, 19858}, {6003, 19858}, {6004, 19863}, {6006, 19860}, {6013, 19867}, {6012, 19861}, {6016, 19860}, {6015, 19863}, {6019, 19863}, {6021, 19868}, {6027, 19867}, {6033, 19877}, {6032, 19881}, {6037, 19886}, {6036, 19890}, {6040, 19886}, {6043, 19894}, {6045, 19889}, {6053, 19901}, {6055, 19892}, {6055, 19897}, {6059, 19898}, {6061, 19909}, {6065, 19904}, {6068, 19911}, {6070, 19906}, {6073, 19914}, {6083, 19914}, {6118, 19947}, {6116, 19949}, {6129, 19960}, {6126, 19965}, {6130, 19964}, {6142, 19971}, {6143, 19977}, {6150, 19980}, {6152, 19990}, {6157, 19988}, {6163, 19994}, {6161, 19996}, {6168, 20006}, {6166, 20010}, {6176, 20013}, {6178, 20018}, {6183, 20020}, {6182, 20023}, {6186, 20025}, {6183, 20026}, {6188, 20034}, {6186, 20036}, {6191, 20039}, {6188, 20041}, {6197, 20042}, {6213, 20061}, {6212, 20065}, {6216, 20064}, {6216, 20069}, {6220, 20072}, {6218, 20076}, {6222, 20077}, {6221, 20082}, {6226, 20081}, {6244, 20108}, {6252, 20113}, {6268, 20138}, {6265, 20145}, {6272, 20144}, {6271, 20149}, {6275, 20148}, {6282, 20158}, {6285, 20158}, {6294, 20175}, {6297, 20175}, {6318, 20198}, {6317, 20202}, {6320, 20202}, {6329, 20215}, {6328, 20219}, {6334, 20216}, {6349, 20230}, {6355, 20247}, {6362, 20248}, {6366, 20245}, {6369, 20248}, {6364, 20250}, {6371, 20249}, {6378, 20256}, {6375, 20257}, {6375, 20263}, {6381, 20264}, {6383, 20270}, {6389, 20270}, {6393, 20274}, {6391, 20278}, {6395, 20278}, {6397, 20282}, {6397, 20279}, {6401, 20280}, {6400, 20286}, {6406, 20286}, {6412, 20291}, {6405, 20294}, {6406, 20298}, {6410, 20296}, {6409, 20299}, {6417, 20303}, {6415, 20306}, {6418, 20310}, {6419, 20308}, {6424, 20311}, {6422, 20315}, {6426, 20318}, {6431, 20315}, {6431, 20319}, {6435, 20319}, {6432, 20322}, {6438, 20322}, {6439, 20318}, {6431, 20315}, {6434, 20313}, {6427, 20307}, {6431, 20307}, {6451, 20324}, {6448, 20326}, {6444, 20324}, {6438, 20327}, {6446, 20325}, {6448, 20329}, {6444, 20330}, {6443, 20334}, {6447, 20335}, {6438, 20336}, {6437, 20333}, {6436, 20337}, {6424, 20336}, {6412, 20326}, {6414, 20325}, {6411, 20320}, {6410, 20324}, {6407, 20315}, {6404, 20320}, {6389, 20309}, {6386, 20301}, {6384, 20304}, {6381, 20297}, {6376, 20299}, {6371, 20289}, {6369, 20292}, {6353, 20281}, {6353, 20277}, {6344, 20274}, {6349, 20269}, {6340, 20272}, {6347, 20279}, {6334, 20272}, {6340, 20269}, {6326, 20255}, {6322, 20255}, {6316, 20249}, {6318, 20254}, {6322, 20255}, {6320, 20256}, {6326, 20264}, {6284, 20231}, {6288, 20230}, {6294, 20235}, {6298, 20234}, {6290, 20231}, {6290, 20228}, {6295, 20227}, {6283, 20226}, {6277, 20220}, {6279, 20217}, {6277, 20215}, {6277, 20220}, {6270, 20210}, {6270, 20218}, {6261, 20218}, {6254, 20206}, {6253, 20208}, {6247, 20204}, {6245, 20198}, {6249, 20197}, {6237, 20187}, {6235, 20190}, {6232, 20184}, {6228, 20185}, {6229, 20181}, {6221, 20180}, {6213, 20166}, {6220, 20157}, {6216, 20157}, {6216, 20162}, {6213, 20161}, {6215, 20159}, {6204, 20156}, {6206, 20148}, {6199, 20144}, {6201, 20137}, {6191, 20130}, {6195, 20129}, {6194, 20124}, {6186, 20122}, {6188, 20120}, {6184, 20121}, {6182, 20117}, {6177, 20117}, {6176, 20113}, {6164, 20107}, {6160, 20096}, {6164, 20092}, {6162, 20091}, {6160, 20096}, {6155, 20091}, {6159, 20088}, {6159, 20083}, {6164, 20088}, {6165, 20083}, {6158, 20079}, {6151, 20080}, {6150, 20074}, {6145, 20074}, {6142, 20070}, {6137, 20071}, {6129, 20055}, {6125, 20054}, {6125, 20043}, {6121, 20045}, {6122, 20043}, {6117, 20040}, {6120, 20034}, {6117, 20034}, {6107, 20017}, {6110, 20016}, {6105, 20011}, {6104, 20015}, {6095, 20004}, {6094, 19994}, {6092, 19997}, {6087, 19994}, {6089, 19992}, {6084, 19991}, {6083, 19981}, {6069, 19970}, {6071, 19966}, {6064, 19960}, {6068, 19955}, {6064, 19953}, {6069, 19953}, {6069, 19949}, {6064, 19953}, {6061, 19949}, {6057, 19951}, {6057, 19946}, {6053, 19948}, {6053, 19943}, {6047, 19937}, {6048, 19932}, {6045, 19936}, {6046, 19929}, {6042, 19932}, {6037, 19925}, {6039, 19921}, {6034, 19920}, {6032, 19913}, {6029, 19914}, {6029, 19901}, {6027, 19906}, {6025, 19899}, {6020, 19904}, {6016, 19900}, {6020, 19897}, {6014, 19899}, {6011, 19891}, {6006, 19891}, {6005, 19888}, {6010, 19887}, {6005, 19882}, {6006, 19879}, {6002, 19879}, {6005, 19872}, {6001, 19868}, {5999, 19870}, {5997, 19866}, {6000, 19862}, {5997, 19860}, {5995, 19870}, {5999, 19874}, {5995, 19876}, {5995, 19928}, {6010, 19942}, {6007, 19942}, {6012, 19951}, {6015, 19950}, {6020, 19959}, {6024, 19959}, {6032, 19971}, {6033, 19979}, {6038, 19978}, {6036, 19986}, {6038, 19988}, {6040, 19985}, {6039, 19990}, {6045, 19989}, {6047, 19996}, {6063, 20013}, {6060, 20014}, {6067, 20020}, {6069, 20017}, {6081, 20031}, {6081, 20039}, {6089, 20043}, {6099, 20057}, {6099, 20062}, {6105, 20065}, {6104, 20068}, {6107, 20070}, {6101, 20071}, {6106, 20075}, {6109, 20072}, {6114, 20076}, {6114, 20082}, {6122, 20086}, {6127, 20110}, {6132, 20105}, {6136, 20108}, {6136, 20113}, {6141, 20115}, {6142, 20122}, {6145, 20122}, {6144, 20127}, {6149, 20126}, {6169, 20152}, {6177, 20157}, {6201, 20185}, {6203, 20193}, {6206, 20184}, {6212, 20190}, {6208, 20196}, {6209, 20203}, {6214, 20204}, {6215, 20201}, {6235, 20222}, {6238, 20218}, {6248, 20229}, {6244, 20230}, {6255, 20240}, {6252, 20241}, {6255, 20245}, {6260, 20243}, {6265, 20250}, {6263, 20252}, {6267, 20254}, {6277, 20252}, {6283, 20261}, {6282, 20264}, {6296, 20273}, {6306, 20286}, {6310, 20286}, {6307, 20293}, {6315, 20291}, {6327, 20298}, {6325, 20301}, {6329, 20300}, {6360, 20323}, {6361, 20328}, {6358, 20329}, {6361, 20332}, {6361, 20328}, {6372, 20333}, {6369, 20334}, {6380, 20338}, {6388, 20347}, {6386, 20353}, {6391, 20349}, {6393, 20353}, {6389, 20355}, {6394, 20355}, {6392, 20357}, {6397, 20356}, {6393, 20354}, {6394, 20350}, {6401, 20354}, {6398, 20362}, {6412, 20363}, {6409, 20367}, {6415, 20364}, {6425, 20376}, {6434, 20378}, {6459, 20400}, {6478, 20411}, {6479, 20415}, {6481, 20413}, {6483, 20421}, {6485, 20419}, {6489, 20426}, {6492, 20422}, {6502, 20432}, {6505, 20431}, {6506, 20435}, {6510, 20436}, {6508, 20438}, {6514, 20436}, {6521, 20445}, {6527, 20440}, {6537, 20449}, {6537, 20454}, {6527, 20451}, {6530, 20456}, {6542, 20460}, {6544, 20467}, {6549, 20466}, {6555, 20475}, {6558, 20469}, {6564, 20471}, {6580, 20486}, {6575, 20487}, {6581, 20491}, {6580, 20498}, {6587, 20498}, {6589, 20502}, {6594, 20499}, {6599, 20503}, {6591, 20506}, {6598, 20511}, {6597, 20514}, {6602, 20512}, {6616, 20526}, {6615, 20531}, {6621, 20531}, {6622, 20528}, {6642, 20549}, {6640, 20553}, {6646, 20557}, {6651, 20567}, {6659, 20568}, {6659, 20573}, {6664, 20573}, {6667, 20584}, {6673, 20585}, {6679, 20596}, {6682, 20595}, {6679, 20603}, {6693, 20614}, {6713, 20648}, {6710, 20654}, {6709, 20650}, {6713, 20648}, {6717, 20651}, {6712, 20655}, {6720, 20656}, {6724, 20667}, {6730, 20671}, {6730, 20677}, {6734, 20677}, {6732, 20679}, {6747, 20699}, {6761, 20725}, {6758, 20727}, {6762, 20728}, {6762, 20734}, {6765, 20733}, {6764, 20738}, {6769, 20739}, {6773, 20750}, {6771, 20755}, {6776, 20753}, {6775, 20758}, {6778, 20758}, {6779, 20763}, {6782, 20762}, {6781, 20766}, {6790, 20779}, {6787, 20781}, {6788, 20784}, {6791, 20783}, {6798, 20790}, {6796, 20793}, {6800, 20794}, {6807, 20807}, {6804, 20809}, {6807, 20811}, {6809, 20808}, {6811, 20816}, {6813, 20814}, {6815, 20822}, {6821, 20827}, {6820, 20831}, {6827, 20836}, {6835, 20858}, {6832, 20860}, {6835, 20861}, {6836, 20854}, {6843, 20864}, {6846, 20863}, {6856, 20881}, {6860, 20881}, {6859, 20884}, {6871, 20899}, {6870, 20902}, {6874, 20905}, {6872, 20911}, {6875, 20907}, {6875, 20911}, {6879, 20910}, {6881, 20916}, {6882, 20914}, {6902, 20937}, {6901, 20941}, {6912, 20947}, {6910, 20953}, {6918, 20954}, {6918, 20957}, {6927, 20962}, {6926, 20973}, {6937, 20973}, {6945, 20984}, {6969, 20986}, {6963, 20983}, {6968, 20977}, {6975, 20984}, {6972, 20986}, {6994, 20986}, {6976, 20969}, {6972, 20971}, {6970, 20969}, {6973, 20966}, {6955, 20949}, {6959, 20947}, {6953, 20948}, {6940, 20934}, {6944, 20933}, {6936, 20932}, {6929, 20922}, {6931, 20921}, {6922, 20916}, {6911, 20901}, {6913, 20899}, {6907, 20897}, {6907, 20893}, {6904, 20894}, {6904, 20891}, {6908, 20891}, {6903, 20884}, {6903, 20888}, {6900, 20888}, {6893, 20878}, {6887, 20879}, {6884, 20876}, {6886, 20873}, {6889, 20876}, {6885, 20868}, {6883, 20872}, {6879, 20869}, {6878, 20859}, {6858, 20836}, {6860, 20835}, {6855, 20823}, {6845, 20819}, {6850, 20818}, {6842, 20803}, {6847, 20806}, {6846, 20800}, {6839, 20801}, {6841, 20799}, {6835, 20797}, {6832, 20791}, {6830, 20794}, {6821, 20767}, {6808, 20753}, {6797, 20731}, {6798, 20724}, {6793, 20724}, {6795, 20718}, {6791, 20719}, {6790, 20706}, {6783, 20709}, {6756, 20664}, {6758, 20657}, {6754, 20660}, {6750, 20651}, {6753, 20649}, {6750, 20644}, {6749, 20646}, {6726, 20613}, {6727, 20620}, {6722, 20615}, {6724, 20609}, {6716, 20604}, {6720, 20602}, {6716, 20601}, {6717, 20590}, {6710, 20590}, {6684, 20554}, {6678, 20550}, {6680, 20546}, {6665, 20535}, {6667, 20532}, {6656, 20531}, {6640, 20514}, {6641, 20509}, {6655, 20523}, {6637, 20504}, {6637, 20510}, {6619, 20493}, {6621, 20489}, {6632, 20500}, {6633, 20498}, {6622, 20489}, {6625, 20488}, {6621, 20487}, {6617, 20479}, {6617, 20483}, {6607, 20467}, {6599, 20468}, {6608, 20479}, {6605, 20480}, {6585, 20460}, {6574, 20456}, {6570, 20448}, {6573, 20446}, {6572, 20441}, {6566, 20440}, {6564, 20433}, {6562, 20436}, {6559, 20430}, {6554, 20428}, {6551, 20434}, {6543, 20427}, {6537, 20426}, {6528, 20415}, {6532, 20410}, {6526, 20410}, {6523, 20405}, {6520, 20407}, {6522, 20398}, {6519, 20403}, {6514, 20399}, {6514, 20394}, {6511, 20398}, {6502, 20394}, {6499, 20388}, {6501, 20380}, {6498, 20383}, {6487, 20381}, {6483, 20374}, {6477, 20371}, {6476, 20364}, {6472, 20365}, {6472, 20368}, {6468, 20362}, {6465, 20363}, {6466, 20360}, {6461, 20359}, {6463, 20357}, {6459, 20358}, {6457, 20354}, {6446, 20351}, {6449, 20348}, {6445, 20348}, {6448, 20345}, {6443, 20344}, {6444, 20339}, {6446, 20341}, {6450, 20336}, {6455, 20342}, {6461, 20340}, {6469, 20343}, {6472, 20348}, {6477, 20348}, {6462, 20336}, {6462, 20331}, {6482, 20343}, {6486, 20350}, {6491, 20349}, {6493, 20355}, {6498, 20353}, {6498, 20358}, {6492, 20362}, {6504, 20362}, {6500, 20368}, {6504, 20366}, {6506, 20368}, {6503, 20370}, {6509, 20370}, {6513, 20375}, {6520, 20375}, {6519, 20378}, {6515, 20377}, {6521, 20384}, {6524, 20380}, {6533, 20384}, {6534, 20380}, {6539, 20383}, {6538, 20388}, {6535, 20385}, {6533, 20387}, {6538, 20388}, {6537, 20393}, {6546, 20400}, {6553, 20395}, {6557, 20402}, {6559, 20399}, {6561, 20403}, {6565, 20400}, {6572, 20403}, {6578, 20411}, {6570, 20408}, {6569, 20410}, {6574, 20411}, {6572, 20413}, {6586, 20412}, {6596, 20421}, {6593, 20424}, {6598, 20425}, {6599, 20431}, {6600, 20427}, {6602, 20432}, {6603, 20429}, {6611, 20438}, {6608, 20437}, {6613, 20436}, {6626, 20444}, {6627, 20449}, {6629, 20447}, {6643, 20466}, {6645, 20463}, {6647, 20467}, {6659, 20466}, {6685, 20485}, {6687, 20491}, {6690, 20491}, {6688, 20494}, {6693, 20494}, {6695, 20499}, {6702, 20500}, {6701, 20503}, {6705, 20501}, {6717, 20516}, {6719, 20511}, {6722, 20516}, {6723, 20514}, {6728, 20517}, {6726, 20519}, {6735, 20522}, {6743, 20535}, {6746, 20533}, {6747, 20536}, {6749, 20534}, {6762, 20541}, {6766, 20552}, {6770, 20552}, {6778, 20563}, {6781, 20561}, {6788, 20569}, {6788, 20573}, {6790, 20571}, {6806, 20586}, {6804, 20588}, {6808, 20587}, {6808, 20591}, {6818, 20595}, {6824, 20602}, {6821, 20604}, {6834, 20613}, {6833, 20616}, {6839, 20617}, {6865, 20645}, {6864, 20649}, {6872, 20654}, {6872, 20660}, {6877, 20660}, {6886, 20668}, {6895, 20685}, {6899, 20686}, {6900, 20691}, {6925, 20720}, {6934, 20737}, {6939, 20734}, {6940, 20739}, {6937, 20738}, {6941, 20745}, {6945, 20742}, {6947, 20744}, {6944, 20749}, {6952, 20757}, {6953, 20764}, {6962, 20775}, {6960, 20778}, {6968, 20779}, {6967, 20784}, {6972, 20790}, {6973, 20783}, {6978, 20789}, {6976, 20803}, {6978, 20797}, {6979, 20802}, {6985, 20802}, {6984, 20806}, {6995, 20812}, {7000, 20820}, {6997, 20821}, {7004, 20832}, {7009, 20832}, {7029, 20861}, {7025, 20862}, {7032, 20870}, {7032, 20875}, {7035, 20875}, {7034, 20880}, {7039, 20880}, {7037, 20883}, {7043, 20885}, {7042, 20890}, {7047, 20889}, {7057, 20901}, {7055, 20904}, {7059, 20905}, {7062, 20914}, {7063, 20911}, {7073, 20918}, {7074, 20915}, {7077, 20916}, {7075, 20926}, {7078, 20928}, {7080, 20925}, {7075, 20922}, {7077, 20920}, {7084, 20923}, {7096, 20939}, {7097, 20946}, {7108, 20948}, {7104, 20951}, {7122, 20966}, {7132, 20982}, {7133, 20978}, {7134, 20981}, {7139, 20980}, {7147, 20986}, {7194, 20986}, {7185, 20982}, {7188, 20980}, {7179, 20977}, {7175, 20970}, {7160, 20961}, {7165, 20959}, {7157, 20958}, {7153, 20952}, {7149, 20952}, {7150, 20950}, {7128, 20933}, {7129, 20925}, {7122, 20927}, {7121, 20923}, {7111, 20919}, {7107, 20910}, {7103, 20909}, {7104, 20904}, {7099, 20905}, {7095, 20895}, {7089, 20893}, {7080, 20883}, {7079, 20875}, {7075, 20877}, {7075, 20872}, {7071, 20873}, {7064, 20860}, {7059, 20860}, {7054, 20848}, {7045, 20841}, {7045, 20837}, {7040, 20836}, {7038, 20831}, {7035, 20833}, {7028, 20826}, {7032, 20823}, {7028, 20817}, {7029, 20813}, {7027, 20815}, {7021, 20807}, {7022, 20803}, {7019, 20804}, {7013, 20798}, {7017, 20806}, {7009, 20799}, {7010, 20793}, {7007, 20790}, {7007, 20794}, {7005, 20792}, {7007, 20788}, {7002, 20782}, {7004, 20778}, {6992, 20765}, {6995, 20762}, {6989, 20763}, {6988, 20768}, {6982, 20755}, {6969, 20740}, {6973, 20741}, {6957, 20724}, {6953, 20714}, {6959, 20717}, {6947, 20697}, {6942, 20696}, {6923, 20673}, {6918, 20674}, {6922, 20669}, {6907, 20649}, {6898, 20646}, {6901, 20645}, {6899, 20641}, {6893, 20641}, {6894, 20635}, {6891, 20632}, {6892, 20638}, {6887, 20637}, {6887, 20633}, {6878, 20622}, {6873, 20622}, {6871, 20631}, {6863, 20626}, {6874, 20620}, {6863, 20606}, {6868, 20605}, {6866, 20603}, {6861, 20605}, {6865, 20601}, {6860, 20595}, {6845, 20587}, {6849, 20586}, {6848, 20575}, {6841, 20572}, {6841, 20575}, {6839, 20570}, {6836, 20572}, {6830, 20562}, {6830, 20566}, {6822, 20559}, {6819, 20563}, {6819, 20557}, {6813, 20557}, {6813, 20549}, {6809, 20552}, {6801, 20545}, {6807, 20544}, {6801, 20539}, {6799, 20544}, {6794, 20540}, {6794, 20534}, {6788, 20535}, {6781, 20528}, {6780, 20534}, {6773, 20525}, {6764, 20520}, {6765, 20514}, {6760, 20508}, {6760, 20502}, {6743, 20492}, {6741, 20487}, {6739, 20489}, {6752, 20497}, {6751, 20504}, {6730, 20488}, {6726, 20479}, {6724, 20481}, {6720, 20478}, {6722, 20475}, {6717, 20476}, {6708, 20470}, {6712, 20468}, {6717, 20471}, {6716, 20465}, {6718, 20468}, {6710, 20467}, {6703, 20459}, {6699, 20459}, {6701, 20465}, {6674, 20446}, {6678, 20443}, {6665, 20435}, {6667, 20431}, {6660, 20431}, {6662, 20425}, {6651, 20425}, {6651, 20421}, {6644, 20418}, {6645, 20415}, {6642, 20414}, {6640, 20418}, {6624, 20411}, {6623, 20403}, {6610, 20397}, {6609, 20399}, {6605, 20393}, {6597, 20390}, {6599, 20388}, {6590, 20388}, {6590, 20384}, {6584, 20383}, {6573, 20372}, {6568, 20373}, {6553, 20363}, {6549, 20357}, {6547, 20359}, {6547, 20355}, {6529, 20347}, {6523, 20340}, {6524, 20337}, {6519, 20338}, {6511, 20332}, {6506, 20332}, {6513, 20339}, {6511, 20341}, {6510, 20338}, {6506, 20338}, {6502, 20332}, {6496, 20331}, {6492, 20325}, {6477, 20318}, {6470, 20310}, {6475, 20309}, {6476, 20303}, {6465, 20300}, {6470, 20296}, {6466, 20296}, {6464, 20300}, {6460, 20294}, {6456, 20294}, {6474, 20307}, {6466, 20307}, {6438, 20284}, {6438, 20280}, {6442, 20278}, {6438, 20277}, {6439, 20275}, {6435, 20276}, {6435, 20273}, {6432, 20274}, {6433, 20270}, {6429, 20272}, {6437, 20281}, {6429, 20278}, {6427, 20274}, {6418, 20270}, {6413, 20261}, {6402, 20255}, {6402, 20250}, {6397, 20247}, {6396, 20249}, {6394, 20245}, {6392, 20247}, {6388, 20238}, {6384, 20240}, {6371, 20231}, {6378, 20229}, {6370, 20224}, {6366, 20216}, {6354, 20207}, {6346, 20193}, {6335, 20184}, {6334, 20177}, {6347, 20188}, {6334, 20174}, {6332, 20177}, {6327, 20173}, {6330, 20167}, {6320, 20156}, {6322, 20164}, {6313, 20155}, {6307, 20143}, {6311, 20143}, {6303, 20135}, {6308, 20141}, {6303, 20142}, {6287, 20125}, {6289, 20123}, {6286, 20122}, {6287, 20114}, {6284, 20113}, {6286, 20108}, {6281, 20105}, {6284, 20101}, {6280, 20095}, {6283, 20094}, {6281, 20091}, {6277, 20097}, {6281, 20098}, {6277, 20102}, {6267, 20087}, {6253, 20080}, {6248, 20072}, {6253, 20070}, {6248, 20061}, {6244, 20060}, {6248, 20056}, {6243, 20054}, {6234, 20042}, {6225, 20042}, {6228, 20040}, {6217, 20027}, {6225, 20030}, {6214, 20010}, {6206, 20006}, {6190, 19983}, {6178, 19976}, {6184, 19971}, {6181, 19967}, {6177, 19968}, {6175, 19962}, {6172, 19964}, {6170, 19955}, {6164, 19954}, {6151, 19938}, {6155, 19899}, {6151, 19898}, {6146, 19904}, {6147, 19908}, {6141, 19919}, {6140, 19914}, {6137, 19920}, {6133, 19921}, {6126, 19907}, {6123, 19908}, {6120, 19904}, {6122, 19902}, {6109, 19895}, {6110, 19900}, {6115, 19903}, {6113, 19905}, {6103, 19899}, {6099, 19890}, {6092, 19884}, {6097, 19887}, {6088, 19873}, {6086, 19875}, {6080, 19870}, {6079, 19873}, {6076, 19872}, {6081, 19864}, {6078, 19866}, {6073, 19860}, {6072, 19864}, {6064, 19863}, {6058, 19857}, {6058, 19853}, {6056, 19854}, {6056, 19849}, {6053, 19852}, {6048, 19844}, {6064, 19846}, {6068, 19841}, {6060, 19841}, {6059, 19837}, {6059, 19843}, {6056, 19837}, {6053, 19844}, {6046, 19838}, {6045, 19841}, {6049, 19842}, {6046, 19846}, {6040, 19835}, {6044, 19839}, {6045, 19832}, {6042, 19831}, {6041, 19835}, {6039, 19830}, {6029, 19830}, {6020, 19816}, {6013, 19819}},
		{{7161, 20981}, {7156, 20983}, {7159, 20979}},
		{{7149, 20971}, {7144, 20973}, {7146, 20970}},
		{{7150, 20968}, {7158, 20974}, {7156, 20980}, {7149, 20976}},
		{{6952, 20969}, {6957, 20967}, {6959, 20972}, {6965, 20975}, {6960, 20978}},
		{{7140, 20961}, {7136, 20965}, {7133, 20962}},
		{{7117, 20960}, {7122, 20959}, {7123, 20964}},
		{{6963, 20964}, {6964, 20959}, {6967, 20964}},
		{{6950, 20959}, {6944, 20964}, {6944, 20960}},
		{{7131, 20952}, {7123, 20953}, {7129, 20950}},
		{{7118, 20944}, {7118, 20947}, {7114, 20946}},
		{{6927, 20945}, {6931, 20943}, {6936, 20952}, {6943, 20952}, {6943, 20959}, {6933, 20955}, {6933, 20949}},
		{{6906, 20940}, {6903, 20943}, {6902, 20941}},
		{{7104, 20931}, {7108, 20934}, {7106, 20938}, {7103, 20935}},
		{{7104, 20925}, {7106, 20928}, {7100, 20932}},
		{{6924, 20923}, {6930, 20924}, {6927, 20927}},
		{{6910, 20922}, {6915, 20929}, {6910, 20929}},
		{{6889, 20915}, {6892, 20918}, {6888, 20918}},
		{{7105, 20914}, {7110, 20916}, {7111, 20921}, {7104, 20918}},
		{{7085, 20910}, {7093, 20912}, {7092, 20917}, {7088, 20917}},
		{{6898, 20906}, {6901, 20913}, {6896, 20911}},
		{{6893, 20899}, {6893, 20905}, {6889, 20902}},
		{{7062, 20888}, {7066, 20887}, {7067, 20892}},
		{{6893, 20887}, {6897, 20887}, {6896, 20891}},
		{{7044, 20881}, {7047, 20881}, {7046, 20884}},
		{{7058, 20880}, {7065, 20880}, {7061, 20884}},
		{{7039, 20874}, {7042, 20879}, {7039, 20878}},
		{{7033, 20865}, {7034, 20870}, {7031, 20867}},
		{{7057, 20860}, {7060, 20864}, {7057, 20864}},
		{{7033, 20846}, {7036, 20847}, {7034, 20850}},
		{{7032, 20842}, {7030, 20846}, {7028, 20844}},
		{{7040, 20837}, {7042, 20841}, {7039, 20840}},
		{{7018, 20831}, {7022, 20830}, {7023, 20834}, {7019, 20834}},
		{{7029, 20821}, {7028, 20824}, {7026, 20822}},
		{{7005, 20806}, {7009, 20806}, {7009, 20811}, {7004, 20810}},
		{{7000, 20801}, {7000, 20808}, {6997, 20804}},
		{{7002, 20784}, {7006, 20788}, {7003, 20789}},
		{{6970, 20753}, {6963, 20754}, {6969, 20751}},
		{{6942, 20738}, {6944, 20743}, {6940, 20741}},
		{{6954, 20734}, {6959, 20738}, {6957, 20740}, {6952, 20736}},
		{{6946, 20706}, {6948, 20704}, {6950, 20707}},
		{{6939, 20699}, {6944, 20699}, {6944, 20704}},
		{{6925, 20696}, {6928, 20698}, {6926, 20700}},
		{{6922, 20695}, {6923, 20691}, {6928, 20693}},
		{{6930, 20683}, {6933, 20688}, {6931, 20689}},
		{{6929, 20683}, {6928, 20686}, {6926, 20684}},
		{{6888, 20655}, {6895, 20655}, {6894, 20658}},
		{{6884, 20639}, {6888, 20649}, {6893, 20650}, {6888, 20653}, {6880, 20645}},
		{{6739, 20640}, {6741, 20639}, {6742, 20643}},
		{{6873, 20636}, {6879, 20634}, {6881, 20637}, {6877, 20641}},
		{{6856, 20634}, {6858, 20632}, {6863, 20638}},
		{{6731, 20622}, {6734, 20625}, {6732, 20627}, {6729, 20624}},
		{{6845, 20620}, {6847, 20619}, {6851, 20627}},
		{{6842, 20598}, {6843, 20602}, {6840, 20601}},
		{{6858, 20594}, {6860, 20596}, {6857, 20600}, {6855, 20598}},
		{{6715, 20590}, {6716, 20594}, {6713, 20592}},
		{{6691, 20567}, {6702, 20581}, {6700, 20583}, {6689, 20570}},
		{{6825, 20567}, {6828, 20565}, {6834, 20572}, {6833, 20575}},
		{{6814, 20565}, {6816, 20567}, {6811, 20573}, {6808, 20569}},
		{{6666, 20555}, {6668, 20560}, {6664, 20559}},
		{{6677, 20550}, {6687, 20562}, {6679, 20558}},
		{{6646, 20538}, {6650, 20537}, {6654, 20541}},
		{{6660, 20530}, {6674, 20547}, {6668, 20546}, {6659, 20533}},
		{{6605, 20510}, {6612, 20519}, {6607, 20517}},
		{{6722, 20510}, {6727, 20511}, {6732, 20517}},
		{{6753, 20505}, {6755, 20503}, {6759, 20509}},
		{{6591, 20482}, {6595, 20480}, {6599, 20486}},
		{{6611, 20479}, {6616, 20488}, {6608, 20482}},
		{{6572, 20465}, {6581, 20467}, {6584, 20472}, {6581, 20474}},
		{{6564, 20455}, {6569, 20461}, {6564, 20460}},
		{{6666, 20437}, {6666, 20440}, {6663, 20439}},
		{{6622, 20437}, {6626, 20441}, {6622, 20441}},
		{{6563, 20437}, {6568, 20446}, {6562, 20443}},
		{{6561, 20435}, {6561, 20439}, {6555, 20438}},
		{{6519, 20418}, {6518, 20423}, {6513, 20422}, {6513, 20419}},
		{{6523, 20412}, {6525, 20410}, {6527, 20413}},
		{{6617, 20409}, {6623, 20409}, {6620, 20412}},
		{{6610, 20401}, {6613, 20404}, {6609, 20405}},
		{{6559, 20398}, {6556, 20401}, {6555, 20399}},
		{{6544, 20397}, {6544, 20394}, {6547, 20395}},
		{{6596, 20395}, {6598, 20393}, {6608, 20400}, {6603, 20401}},
		{{6539, 20388}, {6545, 20387}, {6551, 20393}, {6549, 20395}},
		{{6584, 20388}, {6586, 20386}, {6592, 20391}},
		{{6578, 20384}, {6584, 20384}, {6584, 20388}},
		{{6494, 20386}, {6494, 20383}, {6497, 20384}},
		{{6482, 20378}, {6484, 20383}, {6480, 20380}},
		{{6557, 20368}, {6564, 20372}, {6565, 20370}, {6570, 20376}, {6557, 20372}},
		{{6546, 20364}, {6549, 20362}, {6552, 20365}},
		{{6405, 20362}, {6405, 20359}, {6408, 20360}},
		{{6539, 20359}, {6547, 20362}, {6543, 20364}},
		{{6520, 20357}, {6526, 20358}, {6523, 20363}},
		{{6451, 20358}, {6455, 20358}, {6455, 20361}},
		{{6430, 20357}, {6436, 20356}, {6434, 20359}},
		{{6532, 20351}, {6534, 20356}, {6530, 20353}},
		{{6522, 20347}, {6527, 20348}, {6529, 20353}},
		{{6515, 20342}, {6518, 20340}, {6521, 20347}},
		{{6480, 20328}, {6484, 20333}, {6494, 20337}, {6487, 20339}, {6479, 20332}},
		{{6388, 20320}, {6391, 20323}, {6386, 20325}, {6384, 20323}},
		{{6470, 20319}, {6474, 20322}, {6472, 20324}},
		{{6456, 20312}, {6463, 20314}, {6460, 20318}},
		{{6371, 20310}, {6372, 20314}, {6368, 20314}},
		{{6466, 20309}, {6471, 20308}, {6468, 20311}},
		{{6427, 20303}, {6426, 20306}, {6420, 20305}},
		{{6354, 20303}, {6362, 20301}, {6361, 20303}, {6368, 20306}, {6368, 20311}, {6359, 20309}},
		{{6357, 20296}, {6351, 20298}, {6355, 20294}},
		{{6431, 20290}, {6435, 20290}, {6435, 20294}},
		{{6352, 20283}, {6358, 20288}, {6354, 20288}},
		{{6331, 20278}, {6327, 20281}, {6327, 20278}},
		{{6399, 20266}, {6404, 20266}, {6405, 20271}},
		{{6392, 20262}, {6398, 20263}, {6396, 20265}},
		{{6303, 20263}, {6306, 20260}, {6311, 20265}, {6306, 20266}},
		{{6298, 20254}, {6302, 20257}, {6300, 20259}},
		{{6279, 20241}, {6282, 20240}, {6291, 20247}, {6287, 20249}},
		{{6274, 20233}, {6278, 20241}, {6272, 20237}},
		{{6187, 20148}, {6193, 20151}, {6194, 20157}, {6187, 20152}},
		{{6179, 20142}, {6182, 20141}, {6182, 20145}},
		{{6274, 20103}, {6281, 20106}, {6278, 20107}},
		{{6156, 20080}, {6159, 20083}, {6156, 20085}},
		{{6132, 20074}, {6133, 20078}, {6130, 20077}},
		{{6092, 20021}, {6097, 20025}, {6096, 20028}, {6092, 20027}},
		{{6201, 20005}, {6204, 20005}, {6204, 20009}},
		{{6079, 20001}, {6076, 20004}, {6075, 20002}},
		{{6163, 19995}, {6164, 20000}, {6161, 19997}},
		{{6181, 19969}, {6182, 19973}, {6178, 19976}},
		{{6168, 19961}, {6174, 19967}, {6169, 19967}},
		{{6040, 19934}, {6045, 19943}, {6040, 19939}},
		{{6120, 19913}, {6122, 19911}, {6125, 19914}},
		{{6117, 19906}, {6116, 19909}, {6114, 19907}},
		{{6012, 19896}, {6012, 19900}, {6008, 19897}},
		{{5999, 19888}, {6000, 19885}, {6003, 19887}},
	}
	paths2 := clipper.Paths{
		{{6000, 19800}, {6200, 19800}, {6200, 20000}, {6000, 20000}},
		//{{6500, 19800}, {6700, 19800}, {6700, 20000}, {6500, 20000}},
	}
	offsetX := math.Min(float64(paths1[0][0].X), float64(paths2[0][0].X))*-1 + 50
	offsetY := math.Min(float64(paths1[0][0].Y), float64(paths2[0][0].Y))*-1 + 50

	var adjustedPaths1, adjustedPaths2 clipper.Paths

	mult := clipper.CInt(1)
	for _, path1 := range paths1 {
		var p1 clipper.Path
		for _, p := range path1 {
			ip := clipper.IntPoint{X: mult * (p.X + clipper.CInt(offsetX)), Y: mult * (p.Y + clipper.CInt(offsetY))}
			p1 = append(p1, &ip)
		}
		adjustedPaths1 = append(adjustedPaths1, p1)
	}
	for _, path2 := range paths2 {
		var p2 clipper.Path
		for _, p := range path2 {
			ip := clipper.IntPoint{X: mult * (p.X + clipper.CInt(offsetX)), Y: mult * (p.Y + clipper.CInt(offsetY))}
			p2 = append(p2, &ip)
		}
		adjustedPaths2 = append(adjustedPaths2, p2)
	}
	fmt.Println("Adjusted paths:")
	fmt.Println(adjustedPaths1)
	fmt.Println(adjustedPaths2)
	fmt.Println("Original paths:")
	fmt.Println(paths1)
	fmt.Println(paths2)

	var distance1 float64
	if len(paths1) > 50 {
		distance1 = 1.415
	} else {
		distance1 = 1.415
	}
	c := clipper.NewClipper(clipper.IoStrictlySimple)

	img := gocv.NewMatWithSize(1250, 1250, gocv.MatTypeCV8UC3)
	window := gocv.NewWindow("Clipper test")
	window.ResizeWindow(1000, 1000)
	drawPolygonContour(&img, c.CleanPolygons(adjustedPaths2, 1.415), color.RGBA{R: 255})
	drawPolygonContour(&img, c.CleanPolygons(adjustedPaths1, distance1), color.RGBA{G: 255, B: 255, R: 255})

	window.IMShow(img)
	window.WaitKey(0)

	fmt.Println("Attempting to perform Clipper.Execute1")

	c.Clear()
	c.AddPaths(c.CleanPolygons(paths1, distance1), clipper.PtSubject, true)
	c.AddPaths(c.CleanPolygons(paths2, 2), clipper.PtClip, true)

	result, succeeded := c.Execute1(clipper.CtIntersection, clipper.PftEvenOdd, clipper.PftEvenOdd)
	if !succeeded {
		fmt.Printf("particlebank.Overlaps failed to perform clipper.Execute1\n")
	}

	fmt.Println("Result\n", len(result), result)

}

func drawPolygonContour(img *gocv.Mat, paths clipper.Paths, c color.RGBA) {
	pv := ClipperPathsToPointsVector(paths)
	defer pv.Close()
	gocv.Polylines(img, pv, true, c, 1)
}

func ClipperPathsToPointsVector(paths clipper.Paths) gocv.PointsVector {
	// First transform the path to image.edge
	var pts [][]image.Point
	for _, pathv := range paths {
		var pt []image.Point
		for _, p := range pathv {
			pt = append(pt, image.Point{X: int(p.X), Y: int(p.Y)})
		}
		pts = append(pts, pt)
	}

	return gocv.NewPointsVectorFromPoints(pts)
}
